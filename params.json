{"name":"Columns-matcher","body":"When you work with spreadsheets and casual users things do not always go as you want.\r\n\r\nI worked on a project where users have to upload a spreadsheet with a lot of data about clients purchases.\r\nAfter 3 upload they call me because the system \"did not work well\".\r\n\r\nThe files look like these followiong.\r\n\r\nFile 1:\r\n\r\n<table>\r\n  <tr>\r\n    <th>Name</th>\r\n    <th>Surname</th>\r\n    <th>Emails</th>\r\n  </tr>\r\n  <tr>\r\n    <td>John</td>\r\n    <td>Smith</td>\r\n    <td>john.smith@gmail.com</td>\r\n  </tr>\r\n  <tr>\r\n    <td>John</td>\r\n    <td>Doe</td>\r\n    <td>john.doe@hotmail.com</td>\r\n  </tr>\r\n</table>\r\n\r\nFile 2:\r\n\r\n<table>\r\n  <tr>\r\n    <th>Surname</th>\r\n    <th>Name</th>\r\n    <th>E-mail</th>\r\n  </tr>\r\n  <tr>\r\n    <td>Smith</td>\r\n    <td>John</td>\r\n    <td>john.smith@gmail.com</td>\r\n  </tr>\r\n  <tr>\r\n    <td>Doe</td>\r\n    <td>John</td>\r\n    <td>john.doe@hotmail.com</td>\r\n  </tr>\r\n</table>\r\n\r\nFile 3:\r\n\r\n<table>\r\n  <tr>\r\n    <th>Mail</th>\r\n    <th>Nombre</th>\r\n    <th>Apellido</th>\r\n  </tr>\r\n  <tr>\r\n    <td>john.smith@gmail.com</td>\r\n    <td>John</td>\r\n    <td>Smith</td>\r\n  </tr>\r\n  <tr>\r\n    <td>john.doe@hotmail.com</td>\r\n    <td>John</td>\r\n    <td>Doe</td>\r\n  </tr>\r\n</table>\r\n\r\n3 files, 3 different structures. 3 different headers. WTF!\r\nHow can i guess the position of the columns i'm looking for?\r\n\r\nThis gem try to solve the problem\r\n\r\n## Install\r\n\r\nAdd to your Gemfile and run the `bundle` command to install it.\r\n\r\n```ruby\r\ngem \"columns-matcher\"\r\n```\r\n \r\n**N.B. Requires Ruby 1.9.2 or later.**\r\n\r\n## Use\r\n\r\n```ruby\r\n\r\nrequire \"columns-matcher\"\r\n\r\n@matcher = ColumnsMatcher::Matcher.new\r\n\r\n# the column that contains the name can be lebeled with \"NAME\", \"NOME\" or \"NOMBRE\"\r\n@matcher.add_column(\"name\", [\"NAME\", \"NOME\", \"NOMBRE\"])\r\n\r\n# the column that contains the surname can be lebeled with \"SURNAME\", \"COGNOME\" or \"APELLIDOS\"\r\n@matcher.add_column(\"cognome\", [\"SURNAME\", \"COGNOME\", \"APELLIDOS\"])\r\n\r\n# We suppose the header is [\"COGNOME\", \"NOME\", \"INDIRIZZO\"]\r\n@matcher.set_header(header_loaded_from_spreadsheet)\r\n\r\n@matcher.column_of(\"name\") # return 1\r\n@matcher.column_of(\"cognome\") # return 0\r\n```\r\n\r\nFirst try is as exact match. If does not work it try with different case:\r\n\r\n```ruby\r\n\r\nrequire \"columns-matcher\"\r\n\r\n@matcher = ColumnsMatcher::Matcher.new\r\n\r\n# the column that contains the name can be lebeled with \"NAME\", \"NOME\" or \"NOMBRE\"\r\n@matcher.add_column(\"name\", [\"name\", \"nome\", \"nombre\"])\r\n\r\n# We suppose the header is [\"APELLIDO\", \"NOMBRE\", \"ADDRESS\"]\r\n@matcher.set_header(header_loaded_from_spreadsheet)\r\n\r\n@matcher.column_of(\"name\") # return 1\r\n```\r\n\r\nIf I can't find the column with exact match or different case match i can also use reg exp\r\n\r\n```ruby\r\n\r\nrequire \"columns-matcher\"\r\n\r\n@matcher = ColumnsMatcher::Matcher.new\r\n\r\n# the column that contains the name can be lebeled with \"NAME\", \"NOME\" or \"NOMBRE\"\r\n@matcher.add_column(\"email\", [\"[Ee]?[\\-]*mail[s]*\"])\r\n\r\n# We suppose the header is [\"Surname\", \"Name\", \"Emails\"]\r\n@matcher.set_header(header_loaded_from_spreadsheet)\r\n\r\n@matcher.column_of(\"email\") # return 2\r\n```","tagline":"Given an hash of possibles header label find the correct position of a column in the real header. Useful when you don't know the structure of a spreadsheet.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}